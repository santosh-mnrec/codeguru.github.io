>RxJS is a library for reactive programming using Observables, to make it easier to compose asynchronous or callback-based code

In this article, I will show you the real-world example of `RxJS` operator `switchMap.`
Let's consider. You want to load `post` and there related `comments` in a single request.
The naive approach is to make two requests and then combined the result. But by using 	`switchMap` operator, you can load the `post` and there comments in a single API call.

For this tutorial I am using jsonplaceholder website for making http request.
## STEP 1
create a service named `PostService` and then add two method `getPost` and `getPostComments` as show below
```javascript
import { Injectable } from "@angular/core";
import { HttpClient } from "@angular/common/http";
import { switchMap, tap, map } from "rxjs/operators";

@Injectable()
export class PostService {
  rootUrl = "https://jsonplaceholder.typicode.com/";
  constructor(private http: HttpClient) {}
  
  private getPost(id: number) {
    return this.http.get(`${this.rootUrl}posts/${id}`);
  }
  private getComments(postId: number) {
    return this.http.get(`${this.rootUrl}posts/${postId}/comments`);
  }
}
```
You can see I have created two function that returns `Observable<object>`
## STEP 2
create a function named `getPostAndComments` and add following code.

```javascript
 getPostAndComments(id: number) {
    // Get Post
    return this.getPost(id).pipe(
      // Once get the post,cancel the post subscription and
      // switch to comment(s) subscription
      switchMap((post: any) => {
        return this.getComments(post.id).pipe(
          // combined the result and return to caller
          // {post:Object,comments:Array}
          map(comments => {
            return {
              post,
              comments
            };
          })
        );
      })
    );
  }
  ```
<a href="https://1.bp.blogspot.com/-fxjFxTcRMnQ/XqfJEsuyrzI/AAAAAAAAMSY/gNljbuV4TYobS4G6x1UQs6gZ0veV4X8BACLcBGAsYHQ/s1600/switchMap.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="451" data-original-width="451" src="https://1.bp.blogspot.com/-fxjFxTcRMnQ/XqfJEsuyrzI/AAAAAAAAMSY/gNljbuV4TYobS4G6x1UQs6gZ0veV4X8BACLcBGAsYHQ/s1600/switchMap.png" /></a>

See the above flowchart how `switchMap` works?

### STEP 3
Now open the `app.component` and use the API like shown below
```javascript
import { Component } from "@angular/core";
import { PostService } from "./post.service";

@Component({
  selector: "my-app",
  templateUrl: "./app.component.html",
  styleUrls: ["./app.component.css"]
})
export class AppComponent {
  constructor(private postService: PostService) {}
  ngOnInit() {
    this.postService.getPostAndComments(2).subscribe(data => {
      console.log(data);
    });
  }
}
```


### DEMO

<iframe src="https://stackblitz.com/edit/codeguru-switchmap?embed=1&file=src/app/app.component.ts"  hight="100%" width="100%>
h
<!--stackedit_data:
eyJoaXN0b3J5IjpbMjEzODQyMjU3NCwzMDEzMjQ1MjcsLTk3NT
I4NTg1MiwtMjA3MjgzNDM2MCwyMTEzNzE3NzgsMTI0MDE1Njkz
LC0yMDcxODgyODk4XX0=
-->